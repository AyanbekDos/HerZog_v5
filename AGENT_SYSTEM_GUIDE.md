# ü§ñ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Å–∏—Å—Ç–µ–º–µ –∞–≥–µ–Ω—Ç–æ–≤ HerZog v3.0

## üìä –¢–µ–∫—É—â–∞—è —Å—Ö–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

–ö–∞–∂–¥—ã–π –∞–≥–µ–Ω—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø—É **"–ß–∏—Ç–∞–π ‚Üí –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–π ‚Üí –°–æ—Ö—Ä–∞–Ω—è–π"**:

| –ê–≥–µ–Ω—Ç | –ß–∏—Ç–∞–µ—Ç –∏–∑ | –î–æ–±–∞–≤–ª—è–µ—Ç –∫ –¥–∞–Ω–Ω—ã–º | –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ |
|-------|-----------|-------------------|-------------|
| `1.1_group_creator` | `3_prepared/` | `work_groups` (–º–∞—Å—Å–∏–≤ –≥—Ä—É–ø–ø) | `4.1_grouped/` |
| `1.2_group_assigner` | `4.1_grouped/` | `group_uuid` –∫ –∫–∞–∂–¥–æ–π —Ä–∞–±–æ—Ç–µ | `4_conceptualized/` |
| `2_strategist` | `4_conceptualized/` | `schedule_phases` –∫ —Ä–∞–±–æ—Ç–∞–º | `5_scheduled/` |
| `3_accountant` | `5_scheduled/` | `consolidated_volume`, `unit_cost` | `6_accounted/` |
| `4_foreman` | `6_accounted/` | `worker_counts` –∫ —Ä–∞–±–æ—Ç–∞–º | `7_staffed/` |

### –î–≤–∞ UUID —É –∫–∞–∂–¥–æ–π —Ä–∞–±–æ—Ç—ã:
- **`"id"`** - –Ω–æ–≤—ã–π UUID –¥–ª—è —Å–∏—Å—Ç–µ–º—ã HerZog (—Å–æ–∑–¥–∞–µ—Ç—Å—è –≤ `preparer.py`)
- **`"internal_id"`** - –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π UUID –∏–∑ Excel —Å–º–µ—Ç—ã (—Å–æ–∑–¥–∞–µ—Ç—Å—è –≤ `extractor.py`)

---

## üöÄ –ì–∏–±–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ –Ω—É–º–µ—Ä–∞—Ü–∏–∏ –∞–≥–µ–Ω—Ç–æ–≤

### –§–æ—Ä–º–∞—Ç ID –∞–≥–µ–Ω—Ç–æ–≤:
- **–û—Å–Ω–æ–≤–Ω—ã–µ**: `{–≥—Ä—É–ø–ø–∞}_{–∏–º—è}` (–Ω–∞–ø—Ä–∏–º–µ—Ä: `2_strategist`, `3_accountant`)
- **–ü–æ–¥–∞–≥–µ–Ω—Ç—ã**: `{–≥—Ä—É–ø–ø–∞}.{–ø–æ–¥–≥—Ä—É–ø–ø–∞}_{–∏–º—è}` (–Ω–∞–ø—Ä–∏–º–µ—Ä: `1.1_group_creator`, `1.2_group_assigner`)
- **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ**: `{–≥—Ä—É–ø–ø–∞}.{–Ω–æ–º–µ—Ä}_{–∏–º—è}` (–Ω–∞–ø—Ä–∏–º–µ—Ä: `3.5_cost_optimizer`)

### –ì—Ä—É–ø–ø—ã –∞–≥–µ–Ω—Ç–æ–≤:
1. **–ì—Ä—É–ø–ø–∞ 1** - –ö–æ–Ω—Ü–µ–ø—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è (–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —Ä–∞–±–æ—Ç)
2. **–ì—Ä—É–ø–ø–∞ 2** - –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —ç—Ç–∞–ø—ã)
3. **–ì—Ä—É–ø–ø–∞ 3** - –£—á–µ—Ç (–æ–±—ä–µ–º—ã –∏ —Å—Ç–æ–∏–º–æ—Å—Ç—å)
4. **–ì—Ä—É–ø–ø–∞ 4** - –†–µ—Å—É—Ä—Å—ã (—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ª—é–¥–µ–π)

---

## ‚ûï –ö–∞–∫ –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–≥–æ –∞–≥–µ–Ω—Ç–∞

### –í–∞—Ä–∏–∞–Ω—Ç 1: –î–æ–±–∞–≤–∏—Ç—å –ø–æ—Å–ª–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∞–≥–µ–Ω—Ç–∞
```python
from ai_agents.agent_config_v2 import add_agent_after

# –î–æ–±–∞–≤–ª—è–µ–º –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –∫–∞—á–µ—Å—Ç–≤–∞ –ø–æ—Å–ª–µ –≥—Ä—É–ø–ø–∏—Ä–æ–≤—â–∏–∫–∞
new_agent_id = add_agent_after(
    after_agent_id="1.1_group_creator",
    new_agent_id="quality_checker",
    name="–ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –∫–∞—á–µ—Å—Ç–≤–∞",
    description="–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏",
    prompt_file="agent_1.3_quality_checker_prompt.txt"
)
# –†–µ–∑—É–ª—å—Ç–∞—Ç: —Å–æ–∑–¥–∞—Å—Ç—Å—è –∞–≥–µ–Ω—Ç "1.3_quality_checker"
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ–Ω–µ—Ü –≥—Ä—É–ø–ø—ã
```python
from ai_agents.agent_config_v2 import registry

# –î–æ–±–∞–≤–ª—è–µ–º –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –≤ –≥—Ä—É–ø–ø—É 3 (–£—á–µ—Ç)
cost_optimizer_id = registry.add_agent_to_group(
    group=3,
    agent_id="cost_optimizer",
    name="–û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä —Å—Ç–æ–∏–º–æ—Å—Ç–∏", 
    description="–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —ç–∫–æ–Ω–æ–º–∏–∏",
    prompt_file="agent_3.5_cost_optimizer_prompt.txt"
)
# –†–µ–∑—É–ª—å—Ç–∞—Ç: —Å–æ–∑–¥–∞—Å—Ç—Å—è –∞–≥–µ–Ω—Ç "3.2_cost_optimizer" (–∏–ª–∏ —Å–ª–µ–¥—É—é—â–∏–π —Å–≤–æ–±–æ–¥–Ω—ã–π –Ω–æ–º–µ—Ä)
```

### –®–∞–≥–∏ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∞–≥–µ–Ω—Ç–∞:

1. **–°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–º–ø—Ç —Ñ–∞–π–ª** –≤ –ø–∞–ø–∫–µ `src/prompts/`
2. **–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –∞–≥–µ–Ω—Ç–∞** (–∫–æ–¥ –≤—ã—à–µ)
3. **–°–æ–∑–¥–∞—Ç—å –ª–æ–≥–∏–∫—É –æ–±—Ä–∞–±–æ—Ç–∫–∏** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
   ```python
   from ai_agents.agent_logic_v2 import processor
   
   # –§—É–Ω–∫—Ü–∏—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–≥–µ–Ω—Ç–∞
   def extract_for_new_agent(project_data):
       return {
           'work_groups': project_data.get('work_groups', []),
           'directives': project_data.get('directives', {})
       }
   
   # –§—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—Ç–≤–µ—Ç–∞ LLM
   def process_new_agent_output(llm_response, project_data):
       updated_data = project_data.copy()
       # ... –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞ ...
       updated_data['new_agent_result'] = parsed_response
       return updated_data
   
   # –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
   processor.register_input_extractor("3.5_cost_optimizer", extract_for_new_agent)
   processor.register_output_processor("3.5_cost_optimizer", process_new_agent_output)
   ```

4. **–û–±–Ω–æ–≤–∏—Ç—å –ø–∞–π–ø–ª–∞–π–Ω** –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –∞–≥–µ–Ω—Ç–∞

---

## üîß –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ç–µ–∫—É—â—É—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∞–≥–µ–Ω—Ç–æ–≤:
```python
from ai_agents.agent_config_v2 import registry

for agent_id in registry.get_pipeline_sequence():
    config = registry.get_agent(agent_id)
    print(f"{agent_id}: {config['name']}")
```

### –ü–æ–ª—É—á–∏—Ç—å –∞–≥–µ–Ω—Ç–æ–≤ –≤ –≥—Ä—É–ø–ø–µ:
```python
# –í—Å–µ –∞–≥–µ–Ω—Ç—ã –≥—Ä—É–ø–ø—ã 1 (–ö–æ–Ω—Ü–µ–ø—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è)
group_1_agents = registry.get_agents_by_group(1)
for agent in group_1_agents:
    print(f"{agent['agent_id']}: {agent['name']}")
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã:
```python
errors = registry.validate_pipeline()
if errors:
    print("–û—à–∏–±–∫–∏:", errors)
else:
    print("–°–∏—Å—Ç–µ–º–∞ –≤–∞–ª–∏–¥–Ω–∞!")
```

---

## üéØ –ì–æ—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è

### 1. –ö–æ–Ω—Ç—Ä–æ–ª—å –∫–∞—á–µ—Å—Ç–≤–∞ –º–µ–∂–¥—É —ç—Ç–∞–ø–∞–º–∏
```python
add_agent_after("1.1_group_creator", "quality_checker", ...)  # 1.3_quality_checker
add_agent_after("2_strategist", "schedule_validator", ...)     # 2.2_schedule_validator
```

### 2. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏ –∞–Ω–∞–ª–∏–∑
```python
registry.add_agent_to_group(3, "cost_optimizer", ...)     # 3.2_cost_optimizer  
registry.add_agent_to_group(3, "risk_analyzer", ...)      # 3.3_risk_analyzer
registry.add_agent_to_group(4, "resource_optimizer", ...) # 4.2_resource_optimizer
```

### 3. –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∏
```python
registry.add_agent_to_group(2, "safety_planner", ...)     # 2.2_safety_planner
registry.add_agent_to_group(2, "equipment_planner", ...)  # 2.3_equipment_planner
```

---

## üìÅ –§–∞–π–ª—ã –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã

- `src/ai_agents/agent_config_v2.py` - –ì–∏–±–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∞–≥–µ–Ω—Ç–æ–≤
- `src/ai_agents/agent_logic_v2.py` - –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö
- `examples/add_new_agent_example.py` - –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∞–≥–µ–Ω—Ç–æ–≤

---

## ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã

1. **–õ–µ–≥–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∞–≥–µ–Ω—Ç–æ–≤** - –æ–¥–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤–º–µ—Å—Ç–æ –ø—Ä–∞–≤–∫–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —Ñ–∞–π–ª–æ–≤
2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω—É–º–µ—Ä–∞—Ü–∏—è** - —Å–∏—Å—Ç–µ–º–∞ —Å–∞–º–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –Ω–æ–º–µ—Ä–∞ –ø–æ–¥–≥—Ä—É–ø–ø
3. **–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ —Ñ—É–Ω–∫—Ü–∏—è–º** - –ª–æ–≥–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ —ç—Ç–∞–ø—ã –ø–∞–π–ø–ª–∞–π–Ω–∞
4. **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - —Å—Ç–∞—Ä—ã–µ –∞–≥–µ–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
5. **–í–∞–ª–∏–¥–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏
6. **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∞–≥–µ–Ω—Ç–æ–≤

üéâ **–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –ª–µ–≥–∫–æ–º—É —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é!**