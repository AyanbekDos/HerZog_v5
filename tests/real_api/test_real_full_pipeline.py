#!/usr/bin/env python3
"""
–ü–û–õ–ù–´–ô –ò–ù–¢–ï–ì–†–ê–¶–ò–û–ù–ù–´–ô –¢–ï–°–¢ —Å —Ä–µ–∞–ª—å–Ω—ã–º Gemini API
–¢–µ—Å—Ç–∏—Ä—É–µ—Ç —Ä–∞–±–æ—Ç—É –≤—Å–µ—Ö —á–µ—Ç—ã—Ä–µ—Ö –∞–≥–µ–Ω—Ç–æ–≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ —Å –Ω–∞—Å—Ç–æ—è—â–∏–º –ò–ò
"""

import json
import os
import sys
import asyncio
import tempfile
import shutil
from datetime import datetime, timedelta
from typing import Dict, List

# –î–æ–±–∞–≤–ª—è–µ–º –ø—É—Ç—å –∫ –º–æ–¥—É–ª—è–º
sys.path.insert(0, os.path.join(os.path.dirname(__file__), '..', '..'))

from src.ai_agents.work_packager import WorkPackager
from src.ai_agents.works_to_packages import WorksToPackagesAssigner
from src.ai_agents.counter import WorkVolumeCalculator
from src.ai_agents.scheduler_and_staffer import SchedulerAndStaffer

class TestRealFullPipeline:
    
    def __init__(self):
        self.test_project_path = None
        self.api_stats = {
            'total_calls': 0,
            'total_tokens': 0,
            'calls_per_agent': {},
            'tokens_per_agent': {}
        }
    
    def setup_real_full_project(self):
        """–°–æ–∑–¥–∞–µ—Ç –ø–æ–ª–Ω—ã–π —Ç–µ—Å—Ç–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏"""
        
        # –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—É—é –ø–∞–ø–∫—É –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        self.test_project_path = tempfile.mkdtemp(prefix='test_real_full_herzog_')
        
        # –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –±–ª–æ–∫–∏ (12 –Ω–µ–¥–µ–ª—å –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞)
        start_date = datetime(2024, 3, 1)
        timeline_blocks = []
        
        for week in range(1, 13):
            week_start = start_date + timedelta(weeks=week-1)
            week_end = week_start + timedelta(days=6)
            
            timeline_blocks.append({
                "week_id": week,
                "start_date": week_start.strftime("%Y-%m-%d"),
                "end_date": week_end.strftime("%Y-%m-%d")
            })
        
        # –°–æ–∑–¥–∞–µ–º –æ–±—à–∏—Ä–Ω—ã–π –Ω–∞–±–æ—Ä —Ä–µ–∞–ª—å–Ω—ã—Ö —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–∞–±–æ—Ç
        real_work_items = [
            # –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç–µ–ª—å–Ω—ã–µ –∏ –¥–µ–º–æ–Ω—Ç–∞–∂–Ω—ã–µ —Ä–∞–±–æ—Ç—ã
            {"id": "work_001", "name": "–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω–æ–π –ø–ª–æ—â–∞–¥–∫–∏", "code": "01.01.001"},
            {"id": "work_002", "name": "–î–µ–º–æ–Ω—Ç–∞–∂ –ø–µ—Ä–µ–≥–æ—Ä–æ–¥–æ–∫ –∏–∑ –∫–∏—Ä–ø–∏—á–∞", "code": "08.01.001"},
            {"id": "work_003", "name": "–î–µ–º–æ–Ω—Ç–∞–∂ –ø–æ–∫—Ä—ã—Ç–∏—è –ø–æ–ª–∞ –ª–∏–Ω–æ–ª–µ—É–º", "code": "08.02.015"},
            {"id": "work_004", "name": "–î–µ–º–æ–Ω—Ç–∞–∂ –ø–æ–¥–≤–µ—Å–Ω–æ–≥–æ –ø–æ—Ç–æ–ª–∫–∞ –ê—Ä–º—Å—Ç—Ä–æ–Ω–≥", "code": "08.03.001"},
            {"id": "work_005", "name": "–û—á–∏—Å—Ç–∫–∞ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ –æ—Ç –æ–±–æ–µ–≤", "code": "08.04.001"},
            {"id": "work_006", "name": "–î–µ–º–æ–Ω—Ç–∞–∂ —Å—Ç–∞—Ä–æ–π —ç–ª–µ–∫—Ç—Ä–æ–ø—Ä–æ–≤–æ–¥–∫–∏", "code": "08.05.001"},
            {"id": "work_007", "name": "–í—ã–≤–æ–∑ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω–æ–≥–æ –º—É—Å–æ—Ä–∞", "code": "08.99.001"},
            
            # –û–±—â–µ—Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–∞–±–æ—Ç—ã
            {"id": "work_008", "name": "–í–æ–∑–≤–µ–¥–µ–Ω–∏–µ –ø–µ—Ä–µ–≥–æ—Ä–æ–¥–æ–∫ –∏–∑ –ø–µ–Ω–æ–±–ª–æ–∫–æ–≤ D500", "code": "07.01.001"},
            {"id": "work_009", "name": "–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –¥–≤–µ—Ä–Ω—ã—Ö –∏ –æ–∫–æ–Ω–Ω—ã—Ö –ø—Ä–æ–µ–º–æ–≤", "code": "07.02.001"},
            {"id": "work_010", "name": "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–µ—Ä–µ–º—ã—á–µ–∫ –Ω–∞–¥ –ø—Ä–æ–µ–º–∞–º–∏", "code": "07.03.001"},
            {"id": "work_011", "name": "–ê—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–ª–∞–¥–∫–∏", "code": "07.04.001"},
            
            # –≠–ª–µ–∫—Ç—Ä–æ–º–æ–Ω—Ç–∞–∂–Ω—ã–µ —Ä–∞–±–æ—Ç—ã
            {"id": "work_012", "name": "–ü—Ä–æ–∫–ª–∞–¥–∫–∞ –∫–∞–±–µ–ª—è –í–í–ì 3—Ö2.5 —Å–∫—Ä—ã—Ç–æ –≤ —Å—Ç–µ–Ω–∞—Ö", "code": "19.03.012"},
            {"id": "work_013", "name": "–ü—Ä–æ–∫–ª–∞–¥–∫–∞ –∫–∞–±–µ–ª—è –í–í–ì 3—Ö1.5 –¥–ª—è –æ—Å–≤–µ—â–µ–Ω–∏—è", "code": "19.03.015"},
            {"id": "work_014", "name": "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ–¥—Ä–æ–∑–µ—Ç–Ω–∏–∫–æ–≤ —Å–∫—Ä—ã—Ç—ã—Ö", "code": "19.04.001"},
            {"id": "work_015", "name": "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä–∞—Å–ø–∞—è—á–Ω—ã—Ö –∫–æ—Ä–æ–±–æ–∫", "code": "19.04.002"},
            {"id": "work_016", "name": "–ú–æ–Ω—Ç–∞–∂ —Ä–æ–∑–µ—Ç–æ–∫ —Å–∫—Ä—ã—Ç–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏", "code": "19.05.001"},
            {"id": "work_017", "name": "–ú–æ–Ω—Ç–∞–∂ –≤—ã–∫–ª—é—á–∞—Ç–µ–ª–µ–π –æ–¥–Ω–æ–∫–ª–∞–≤–∏—à–Ω—ã—Ö", "code": "19.05.003"},
            {"id": "work_018", "name": "–ú–æ–Ω—Ç–∞–∂ –≤—ã–∫–ª—é—á–∞—Ç–µ–ª–µ–π –¥–≤—É—Ö–∫–ª–∞–≤–∏—à–Ω—ã—Ö", "code": "19.05.004"},
            {"id": "work_019", "name": "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–≤–µ—Ç–∏–ª—å–Ω–∏–∫–æ–≤ –ø–æ—Ç–æ–ª–æ—á–Ω—ã—Ö LED", "code": "19.06.001"},
            {"id": "work_020", "name": "–ú–æ–Ω—Ç–∞–∂ —ç–ª–µ–∫—Ç—Ä–æ—â–∏—Ç–∫–∞ –Ω–∞ 24 –º–æ–¥—É–ª—è", "code": "19.07.001"},
            {"id": "work_021", "name": "–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∏ –ø—É—Å–∫–æ–Ω–∞–ª–∞–¥–∫–∞ —ç–ª–µ–∫—Ç—Ä–æ–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è", "code": "19.08.001"},
            
            # –°–∞–Ω—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä–∞–±–æ—Ç—ã
            {"id": "work_022", "name": "–ü—Ä–æ–∫–ª–∞–¥–∫–∞ —Ç—Ä—É–± –≤–æ–¥–æ–ø—Ä–æ–≤–æ–¥–∞ –ü–ù–î 25–º–º", "code": "18.01.001"},
            {"id": "work_023", "name": "–ü—Ä–æ–∫–ª–∞–¥–∫–∞ —Ç—Ä—É–± –≤–æ–¥–æ–ø—Ä–æ–≤–æ–¥–∞ –ü–ù–î 32–º–º", "code": "18.01.002"},
            {"id": "work_024", "name": "–ü—Ä–æ–∫–ª–∞–¥–∫–∞ —Ç—Ä—É–± –∫–∞–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ –ü–í–• 50–º–º", "code": "18.02.001"},
            {"id": "work_025", "name": "–ü—Ä–æ–∫–ª–∞–¥–∫–∞ —Ç—Ä—É–± –∫–∞–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ –ü–í–• 110–º–º", "code": "18.02.002"},
            {"id": "work_026", "name": "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤–æ–¥–æ—Ä–æ–∑–µ—Ç–æ–∫", "code": "18.03.001"},
            {"id": "work_027", "name": "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–∞–Ω–∞–ª–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã—Ö –≤—ã–ø—É—Å–∫–æ–≤", "code": "18.03.002"},
            {"id": "work_028", "name": "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–º–µ—Å–∏—Ç–µ–ª—è –¥–ª—è —Ä–∞–∫–æ–≤–∏–Ω—ã", "code": "18.04.001"},
            {"id": "work_029", "name": "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–º–µ—Å–∏—Ç–µ–ª—è –¥–ª—è –≤–∞–Ω–Ω—ã", "code": "18.04.002"},
            {"id": "work_030", "name": "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —É–Ω–∏—Ç–∞–∑–∞ –Ω–∞–ø–æ–ª—å–Ω–æ–≥–æ", "code": "18.05.001"},
            {"id": "work_031", "name": "–ú–æ–Ω—Ç–∞–∂ —Ä–∞–∫–æ–≤–∏–Ω—ã —Å –ø—å–µ–¥–µ—Å—Ç–∞–ª–æ–º", "code": "18.06.001"},
            {"id": "work_032", "name": "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤–∞–Ω–Ω—ã –∞–∫—Ä–∏–ª–æ–≤–æ–π", "code": "18.07.001"},
            
            # –°—Ç–æ–ª—è—Ä–Ω–æ-–ø–ª–æ—Ç–Ω–∏—á–Ω—ã–µ —Ä–∞–±–æ—Ç—ã
            {"id": "work_033", "name": "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–≤–µ—Ä–Ω—ã—Ö –±–ª–æ–∫–æ–≤ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö", "code": "10.01.001"},
            {"id": "work_034", "name": "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–≤–µ—Ä–Ω—ã—Ö –±–ª–æ–∫–æ–≤ –≤—Ö–æ–¥–Ω—ã—Ö", "code": "10.01.002"},
            {"id": "work_035", "name": "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–∫–æ–Ω–Ω—ã—Ö –±–ª–æ–∫–æ–≤ –ü–í–•", "code": "10.02.001"},
            {"id": "work_036", "name": "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ–¥–æ–∫–æ–Ω–Ω–∏–∫–æ–≤", "code": "10.03.001"},
            {"id": "work_037", "name": "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ—Ç–∫–æ—Å–æ–≤ –æ–∫–æ–Ω–Ω—ã—Ö", "code": "10.04.001"},
            
            # –û—Ç–¥–µ–ª–æ—á–Ω—ã–µ —Ä–∞–±–æ—Ç—ã —Å—Ç–µ–Ω
            {"id": "work_038", "name": "–®—Ç—É–∫–∞—Ç—É—Ä–∫–∞ —Å—Ç–µ–Ω —Ü–µ–º–µ–Ω—Ç–Ω–æ-–ø–µ—Å—á–∞–Ω—ã–º —Ä–∞—Å—Ç–≤–æ—Ä–æ–º", "code": "15.01.001"},
            {"id": "work_039", "name": "–®—Ç—É–∫–∞—Ç—É—Ä–∫–∞ —Å—Ç–µ–Ω –≥–∏–ø—Å–æ–≤–æ–π —Å–º–µ—Å—å—é", "code": "15.01.002"},
            {"id": "work_040", "name": "–®–ø–∞–∫–ª–µ–≤–∫–∞ —Å—Ç–µ–Ω —Å—Ç–∞—Ä—Ç–æ–≤–∞—è", "code": "15.02.001"},
            {"id": "work_041", "name": "–®–ø–∞–∫–ª–µ–≤–∫–∞ —Å—Ç–µ–Ω —Ñ–∏–Ω–∏—à–Ω–∞—è", "code": "15.02.002"},
            {"id": "work_042", "name": "–ì—Ä—É–Ω—Ç–æ–≤–∫–∞ —Å—Ç–µ–Ω –≥–ª—É–±–æ–∫–æ–≥–æ –ø—Ä–æ–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è", "code": "15.03.001"},
            {"id": "work_043", "name": "–ü–æ–∫—Ä–∞—Å–∫–∞ —Å—Ç–µ–Ω –≤–æ–¥–æ—ç–º—É–ª—å—Å–∏–æ–Ω–Ω–æ–π –∫—Ä–∞—Å–∫–æ–π", "code": "15.06.001"},
            {"id": "work_044", "name": "–ü–æ–∫–ª–µ–π–∫–∞ –æ–±–æ–µ–≤ –≤–∏–Ω–∏–ª–æ–≤—ã—Ö", "code": "15.05.001"},
            {"id": "work_045", "name": "–£–∫–ª–∞–¥–∫–∞ –∫–µ—Ä–∞–º–∏—á–µ—Å–∫–æ–π –ø–ª–∏—Ç–∫–∏ –Ω–∞ —Å—Ç–µ–Ω—ã", "code": "15.04.001"},
            
            # –†–∞–±–æ—Ç—ã –ø–æ –ø–æ–ª–∞–º
            {"id": "work_046", "name": "–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ —Å—Ç—è–∂–∫–∏ –ø–æ–ª–∞ —Ü–µ–º–µ–Ω—Ç–Ω–æ-–ø–µ—Å—á–∞–Ω–æ–π", "code": "11.01.001"},
            {"id": "work_047", "name": "–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –Ω–∞–ª–∏–≤–Ω–æ–≥–æ –ø–æ–ª–∞ —Å–∞–º–æ–≤—ã—Ä–∞–≤–Ω–∏–≤–∞—é—â–µ–≥–æ—Å—è", "code": "11.01.002"},
            {"id": "work_048", "name": "–ì–∏–¥—Ä–æ–∏–∑–æ–ª—è—Ü–∏—è –ø–æ–ª–∞ —Ä—É–ª–æ–Ω–Ω–∞—è", "code": "11.02.001"},
            {"id": "work_049", "name": "–¢–µ–ø–ª–æ–∏–∑–æ–ª—è—Ü–∏—è –ø–æ–ª–∞ –ø–µ–Ω–æ–ø–æ–ª–∏—Å—Ç–∏—Ä–æ–ª–æ–º", "code": "11.02.002"},
            {"id": "work_050", "name": "–£–∫–ª–∞–¥–∫–∞ –∫–µ—Ä–∞–º–∏—á–µ—Å–∫–æ–π –ø–ª–∏—Ç–∫–∏ –Ω–∞ –ø–æ–ª", "code": "11.03.001"},
            {"id": "work_051", "name": "–£–∫–ª–∞–¥–∫–∞ –∫–µ—Ä–∞–º–æ–≥—Ä–∞–Ω–∏—Ç–∞ –Ω–∞ –ø–æ–ª", "code": "11.03.002"},
            {"id": "work_052", "name": "–£–∫–ª–∞–¥–∫–∞ –ª–∞–º–∏–Ω–∞—Ç–∞ 32 –∫–ª–∞—Å—Å", "code": "11.04.001"},
            {"id": "work_053", "name": "–£–∫–ª–∞–¥–∫–∞ –ª–∞–º–∏–Ω–∞—Ç–∞ 33 –∫–ª–∞—Å—Å", "code": "11.04.002"},
            {"id": "work_054", "name": "–£–∫–ª–∞–¥–∫–∞ –ª–∏–Ω–æ–ª–µ—É–º–∞ –∫–æ–º–º–µ—Ä—á–µ—Å–∫–æ–≥–æ", "code": "11.04.003"},
            {"id": "work_055", "name": "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–ª–∏–Ω—Ç—É—Å–∞ –ø–ª–∞—Å—Ç–∏–∫–æ–≤–æ–≥–æ", "code": "11.05.001"},
            {"id": "work_056", "name": "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–ª–∏–Ω—Ç—É—Å–∞ –¥–µ—Ä–µ–≤—è–Ω–Ω–æ–≥–æ", "code": "11.05.002"},
            
            # –†–∞–±–æ—Ç—ã –ø–æ –ø–æ—Ç–æ–ª–∫–∞–º
            {"id": "work_057", "name": "–ú–æ–Ω—Ç–∞–∂ –∫–∞—Ä–∫–∞—Å–∞ –ø–æ–¥–≤–µ—Å–Ω–æ–≥–æ –ø–æ—Ç–æ–ª–∫–∞", "code": "15.07.001"},
            {"id": "work_058", "name": "–û–±—à–∏–≤–∫–∞ –ø–æ—Ç–æ–ª–∫–∞ –≥–∏–ø—Å–æ–∫–∞—Ä—Ç–æ–Ω–æ–º –≤ –æ–¥–∏–Ω —Å–ª–æ–π", "code": "15.07.002"},
            {"id": "work_059", "name": "–ó–∞–¥–µ–ª–∫–∞ —à–≤–æ–≤ –≥–∏–ø—Å–æ–∫–∞—Ä—Ç–æ–Ω–∞ —Å–µ—Ä–ø—è–Ω–∫–æ–π", "code": "15.07.003"},
            {"id": "work_060", "name": "–®–ø–∞–∫–ª–µ–≤–∫–∞ –ø–æ—Ç–æ–ª–∫–∞ —Å—Ç–∞—Ä—Ç–æ–≤–∞—è", "code": "15.07.004"},
            {"id": "work_061", "name": "–®–ø–∞–∫–ª–µ–≤–∫–∞ –ø–æ—Ç–æ–ª–∫–∞ —Ñ–∏–Ω–∏—à–Ω–∞—è", "code": "15.07.005"},
            {"id": "work_062", "name": "–ü–æ–∫—Ä–∞—Å–∫–∞ –ø–æ—Ç–æ–ª–∫–∞ –≤–æ–¥–æ—ç–º—É–ª—å—Å–∏–æ–Ω–Ω–æ–π –∫—Ä–∞—Å–∫–æ–π", "code": "15.07.006"},
            {"id": "work_063", "name": "–ú–æ–Ω—Ç–∞–∂ –ø–æ—Ç–æ–ª–∫–∞ —Ç–∏–ø–∞ –ê—Ä–º—Å—Ç—Ä–æ–Ω–≥", "code": "15.08.001"},
            {"id": "work_064", "name": "–ú–æ–Ω—Ç–∞–∂ –Ω–∞—Ç—è–∂–Ω–æ–≥–æ –ø–æ—Ç–æ–ª–∫–∞", "code": "15.09.001"},
            
            # –ü—Ä–æ—á–∏–µ –∏ —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ —Ä–∞–±–æ—Ç—ã
            {"id": "work_065", "name": "–ú–∞–ª—è—Ä–Ω—ã–µ —Ä–∞–±–æ—Ç—ã –ø–æ –º–µ—Ç–∞–ª–ª–æ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º", "code": "16.01.001"},
            {"id": "work_066", "name": "–ê–Ω—Ç–∏–∫–æ—Ä—Ä–æ–∑–∏–π–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –º–µ—Ç–∞–ª–ª–∞", "code": "16.02.001"},
            {"id": "work_067", "name": "–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –æ—Ç–º–æ—Å—Ç–∫–∏ –≤–æ–∫—Ä—É–≥ –∑–¥–∞–Ω–∏—è", "code": "05.01.001"},
            {"id": "work_068", "name": "–ë–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –ø—Ä–∏–ª–µ–≥–∞—é—â–µ–π —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏", "code": "05.02.001"},
            {"id": "work_069", "name": "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ—á—Ç–æ–≤—ã—Ö —è—â–∏–∫–æ–≤", "code": "10.99.001"},
            {"id": "work_070", "name": "–£–±–æ—Ä–∫–∞ –ø–æ–º–µ—â–µ–Ω–∏–π –ø–æ—Å–ª–µ —Ä–µ–º–æ–Ω—Ç–∞", "code": "99.01.001"},
            {"id": "work_071", "name": "–°–¥–∞—á–∞ –æ–±—ä–µ–∫—Ç–∞ –∑–∞–∫–∞–∑—á–∏–∫—É", "code": "99.02.001"},
        ]
        
        # –°–æ–∑–¥–∞–µ–º –ø–æ–ª–Ω—ã–π truth.json –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞
        full_truth_data = {
            "metadata": {
                "project_id": "real_full_test_project",
                "project_name": "–ö–∞–ø–∏—Ç–∞–ª—å–Ω—ã–π —Ä–µ–º–æ–Ω—Ç 3-–∫–æ–º–Ω–∞—Ç–Ω–æ–π –∫–≤–∞—Ä—Ç–∏—Ä—ã 85 –º¬≤",
                "pipeline_status": [
                    {"agent_name": "work_packager", "status": "pending"}
                ]
            },
            "project_inputs": {
                "target_work_package_count": 12,
                "project_timeline": {
                    "start_date": "2024-03-01",
                    "end_date": "2024-05-24"
                },
                "workforce_range": {
                    "min": 6,
                    "max": 18
                },
                "agent_directives": {
                    "conceptualizer": "–¥–µ–º–æ–Ω—Ç–∞–∂ –æ—Ç–¥–µ–ª—å–Ω–æ –æ—Ç –º–æ–Ω—Ç–∞–∂–∞, –≤—Å—é —ç–ª–µ–∫—Ç—Ä–∏–∫—É –∏ —Å–ª–∞–±–æ—Ç–æ—á–∫—É –≤ –æ–¥–∏–Ω –ø–∞–∫–µ—Ç, —Å–∞–Ω—Ç–µ—Ö–Ω–∏–∫—É –≤ –æ–¥–∏–Ω –±–ª–æ–∫, –æ—Ç–¥–µ–ª–∫—É —Ä–∞–∑–±–∏—Ç—å –ø–æ —Ç–∏–ø–∞–º —Ä–∞–±–æ—Ç",
                    "strategist": "–¥–µ–º–æ–Ω—Ç–∞–∂ –≤ –ø–µ—Ä–≤—ã–µ 2 –Ω–µ–¥–µ–ª–∏, –ø–æ—Ç–æ–º –æ–±—â–µ—Å—Ç—Ä–æ–π–∫–∞, –∏–Ω–∂–µ–Ω–µ—Ä–∫–∞ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ, –æ—Ç–¥–µ–ª–∫–∞ –≤ –∫–æ–Ω—Ü–µ",
                    "accountant": "–ø—Ä–∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–∏ –ø–ª–æ—â–∞–¥–Ω—ã—Ö —Ä–∞–±–æ—Ç –±–µ—Ä–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –ø–ª–æ—â–∞–¥—å, –ø—Ä–∏ –ª–∏–Ω–µ–π–Ω—ã—Ö - —Å—É–º–º–∏—Ä—É–π",
                    "foreman": "–Ω–∞ –æ—Ç–¥–µ–ª–æ—á–Ω—ã–µ —Ä–∞–±–æ—Ç—ã –º–∞–∫—Å–∏–º—É–º –ª—é–¥–µ–π, –Ω–∞ –¥–µ–º–æ–Ω—Ç–∞–∂ –∏ —ç–ª–µ–∫—Ç—Ä–∏–∫—É –ø–æ–º–µ–Ω—å—à–µ"
                },
                "external_context": {
                    "object_characteristics": {
                        "project_type": "–ö–∞–ø–∏—Ç–∞–ª—å–Ω—ã–π —Ä–µ–º–æ–Ω—Ç –∫–≤–∞—Ä—Ç–∏—Ä—ã",
                        "building_type": "–ñ–∏–ª–æ–π –¥–æ–º",
                        "area": "85 –º¬≤",
                        "rooms": "3 –∫–æ–º–Ω–∞—Ç—ã + –∫—É—Ö–Ω—è + —Å–∞–Ω—É–∑–µ–ª"
                    },
                    "site_conditions": {
                        "location_type": "–ñ–∏–ª–æ–π –¥–æ–º –≤ —Ü–µ–Ω—Ç—Ä–µ –≥–æ—Ä–æ–¥–∞",
                        "work_time_restrictions": ["–†–∞–±–æ—Ç—ã —Ç–æ–ª—å–∫–æ –≤ –±—É–¥–Ω–∏–µ –¥–Ω–∏ 9:00-18:00", "–®—É–º–Ω—ã–µ —Ä–∞–±–æ—Ç—ã –¥–æ 17:00"],
                        "access_limitations": "–ü–æ–¥—ä–µ–º –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –Ω–∞ 5 —ç—Ç–∞–∂ –±–µ–∑ –ª–∏—Ñ—Ç–∞"
                    }
                }
            },
            "timeline_blocks": timeline_blocks,
            "source_work_items": real_work_items,
            "results": {
                "work_packages": []
            }
        }
        
        truth_path = os.path.join(self.test_project_path, "true.json")
        with open(truth_path, 'w', encoding='utf-8') as f:
            json.dump(full_truth_data, f, ensure_ascii=False, indent=2)
        
        print(f"‚úÖ –°–æ–∑–¥–∞–Ω –ø–æ–ª–Ω—ã–π —Ä–µ–∞–ª—å–Ω—ã–π –ø—Ä–æ–µ–∫—Ç: {self.test_project_path}")
        print(f"üìä –ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–æ {len(real_work_items)} —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–∞–±–æ—Ç")
        print(f"üìÖ –í—Ä–µ–º–µ–Ω–Ω–æ–π –ø–ª–∞–Ω: {len(timeline_blocks)} –Ω–µ–¥–µ–ª—å")
        return self.test_project_path
    
    def track_api_usage(self, agent_name: str, api_response: Dict):
        """–û—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ API"""
        usage = api_response.get('usage_metadata', {})
        tokens = usage.get('total_token_count', 0)
        
        self.api_stats['total_calls'] += 1
        self.api_stats['total_tokens'] += tokens
        
        if agent_name not in self.api_stats['calls_per_agent']:
            self.api_stats['calls_per_agent'][agent_name] = 0
            self.api_stats['tokens_per_agent'][agent_name] = 0
        
        self.api_stats['calls_per_agent'][agent_name] += 1
        self.api_stats['tokens_per_agent'][agent_name] += tokens
    
    async def test_real_full_pipeline(self):
        """–ü–æ–ª–Ω—ã–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç –≤—Å–µ—Ö –∞–≥–µ–Ω—Ç–æ–≤ —Å —Ä–µ–∞–ª—å–Ω—ã–º API"""
        
        print("ü§ñ === –ü–û–õ–ù–´–ô –ò–ù–¢–ï–ì–†–ê–¶–ò–û–ù–ù–´–ô –¢–ï–°–¢ –° –†–ï–ê–õ–¨–ù–´–ú GEMINI API ===")
        print("‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï: –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ä–µ–∞–ª—å–Ω—ã–µ API –≤—ã–∑–æ–≤—ã!")
        print("üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–π!")
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ API –∫–ª—é—á–∞
        if not os.getenv('GEMINI_API_KEY'):
            print("‚ùå GEMINI_API_KEY –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è")
            return False
        
        # –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç
        project_path = self.setup_real_full_project()
        pipeline_start_time = datetime.now()
        
        try:
            # =============================================
            # –®–ê–ì 1: WORK_PACKAGER
            # =============================================
            print(f"\n{'='*60}")
            print("üèóÔ∏è –®–ê–ì 1: –ó–ê–ü–£–°–ö WORK_PACKAGER")
            print(f"{'='*60}")
            
            agent1 = WorkPackager()
            step1_start = datetime.now()
            result1 = await agent1.process(project_path)
            step1_duration = (datetime.now() - step1_start).total_seconds()
            
            if not result1.get('success'):
                print(f"‚ùå –û—à–∏–±–∫–∞ –Ω–∞ —à–∞–≥–µ 1: {result1.get('error')}")
                return False
            
            # –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç work_packager
            truth_path = os.path.join(project_path, "true.json")
            with open(truth_path, 'r', encoding='utf-8') as f:
                truth_data = json.load(f)
            
            work_packages = truth_data['results']['work_packages']
            print(f"‚úÖ –®–∞–≥ 1 –∑–∞–≤–µ—Ä—à–µ–Ω –∑–∞ {step1_duration:.1f}—Å")
            print(f"üì¶ –°–æ–∑–¥–∞–Ω–æ –ø–∞–∫–µ—Ç–æ–≤: {len(work_packages)}")
            
            for i, pkg in enumerate(work_packages[:3]):  # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–µ 3
                print(f"   {i+1}. {pkg['name']}")
            if len(work_packages) > 3:
                print(f"   ... –∏ –µ—â–µ {len(work_packages)-3} –ø–∞–∫–µ—Ç–æ–≤")
            
            # =============================================
            # –®–ê–ì 2: WORKS_TO_PACKAGES
            # =============================================
            print(f"\n{'='*60}")
            print("üìã –®–ê–ì 2: –ó–ê–ü–£–°–ö WORKS_TO_PACKAGES")
            print(f"{'='*60}")
            
            agent2 = WorksToPackagesAssigner(batch_size=15)  # –ë–∞—Ç—á–∏ –ø–æ 15 –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ API
            step2_start = datetime.now()
            result2 = await agent2.process(project_path)
            step2_duration = (datetime.now() - step2_start).total_seconds()
            
            if not result2.get('success'):
                print(f"‚ùå –û—à–∏–±–∫–∞ –Ω–∞ —à–∞–≥–µ 2: {result2.get('error')}")
                return False
            
            print(f"‚úÖ –®–∞–≥ 2 –∑–∞–≤–µ—Ä—à–µ–Ω –∑–∞ {step2_duration:.1f}—Å")
            print(f"üìä –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ —Ä–∞–±–æ—Ç: {result2.get('works_processed')}")
            print(f"üì¶ –ë–∞—Ç—á–µ–π: {result2.get('batches_processed')}")
            
            # =============================================
            # –®–ê–ì 3: COUNTER
            # =============================================
            print(f"\n{'='*60}")
            print("üßÆ –®–ê–ì 3: –ó–ê–ü–£–°–ö COUNTER")
            print(f"{'='*60}")
            
            agent3 = WorkVolumeCalculator()
            step3_start = datetime.now()
            result3 = await agent3.process(project_path)
            step3_duration = (datetime.now() - step3_start).total_seconds()
            
            if not result3.get('success'):
                print(f"‚ùå –û—à–∏–±–∫–∞ –Ω–∞ —à–∞–≥–µ 3: {result3.get('error')}")
                return False
            
            print(f"‚úÖ –®–∞–≥ 3 –∑–∞–≤–µ—Ä—à–µ–Ω –∑–∞ {step3_duration:.1f}—Å")
            print(f"üìä –†–∞—Å—Å—á–∏—Ç–∞–Ω–æ –ø–∞–∫–µ—Ç–æ–≤: {result3.get('packages_calculated')}")
            
            # =============================================
            # –®–ê–ì 4: SCHEDULER_AND_STAFFER
            # =============================================
            print(f"\n{'='*60}")
            print("üìÖ –®–ê–ì 4: –ó–ê–ü–£–°–ö SCHEDULER_AND_STAFFER")
            print(f"{'='*60}")
            
            agent4 = SchedulerAndStaffer()
            step4_start = datetime.now()
            result4 = await agent4.process(project_path)
            step4_duration = (datetime.now() - step4_start).total_seconds()
            
            if not result4.get('success'):
                print(f"‚ùå –û—à–∏–±–∫–∞ –Ω–∞ —à–∞–≥–µ 4: {result4.get('error')}")
                return False
            
            print(f"‚úÖ –®–∞–≥ 4 –∑–∞–≤–µ—Ä—à–µ–Ω –∑–∞ {step4_duration:.1f}—Å")
            print(f"üìÖ –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ –ø–∞–∫–µ—Ç–æ–≤: {result4.get('packages_scheduled')}")
            
            # =============================================
            # –§–ò–ù–ê–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–ó
            # =============================================
            pipeline_duration = (datetime.now() - pipeline_start_time).total_seconds()
            
            print(f"\n{'='*60}")
            print("üìä –§–ò–ù–ê–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–ó –†–ï–ó–£–õ–¨–¢–ê–¢–û–í")
            print(f"{'='*60}")
            
            # –ó–∞–≥—Ä—É–∂–∞–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
            with open(truth_path, 'r', encoding='utf-8') as f:
                final_data = json.load(f)
            
            final_packages = final_data['results']['work_packages']
            schedule_info = final_data['results'].get('schedule', {})
            staffing_info = final_data['results'].get('staffing', {})
            
            print(f"üèóÔ∏è –ò–¢–û–ì–ò –û–ë–†–ê–ë–û–¢–ö–ò –ü–†–û–ï–ö–¢–ê:")
            print(f"   üìã –ò—Å—Ö–æ–¥–Ω–æ —Ä–∞–±–æ—Ç: 71")
            print(f"   üì¶ –°–æ–∑–¥–∞–Ω–æ –ø–∞–∫–µ—Ç–æ–≤: {len(final_packages)}")
            print(f"   üìÖ –ü—Ä–æ–µ–∫—Ç –Ω–∞: {schedule_info.get('project_duration_weeks', 0)} –Ω–µ–¥–µ–ª—å")
            print(f"   üë• –ü–∏–∫–æ–≤–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞: {staffing_info.get('peak_workforce', 0)} —á–µ–ª–æ–≤–µ–∫")
            print(f"   ‚è±Ô∏è –í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏: {pipeline_duration:.1f} —Å–µ–∫—É–Ω–¥")
            
            print(f"\nüèóÔ∏è –°–û–ó–î–ê–ù–ù–´–ï –ü–ê–ö–ï–¢–´ –†–ê–ë–û–¢:")
            for i, pkg in enumerate(final_packages, 1):
                name = pkg.get('name', '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è')
                calc = pkg.get('calculations', {})
                volume = calc.get('quantity', 0)
                unit = calc.get('unit', '')
                schedule = pkg.get('schedule_blocks', [])
                
                print(f"   {i:2d}. {name}")
                print(f"       –û–±—ä–µ–º: {volume} {unit}")
                print(f"       –ù–µ–¥–µ–ª–∏: {schedule}")
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞—á–µ—Å—Ç–≤–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
            errors = self._validate_final_result(final_data)
            
            if errors:
                print(f"\n‚ö†Ô∏è –û–ë–ù–ê–†–£–ñ–ï–ù–´ –ü–†–û–ë–õ–ï–ú–´:")
                for error in errors:
                    print(f"   - {error}")
                print(f"\nüí° API —Ç–µ—Å—Ç –ø—Ä–æ—à–µ–ª, –Ω–æ –∫–∞—á–µ—Å—Ç–≤–æ —Ç—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏")
                return True
            else:
                print(f"\nüéâ –í–°–ï –≠–¢–ê–ü–´ –ó–ê–í–ï–†–®–ï–ù–´ –£–°–ü–ï–®–ù–û!")
                print(f"‚úÖ –†–µ–∞–ª—å–Ω—ã–π –ò–ò —Å–æ–∑–¥–∞–ª –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä–Ω—ã–π –ø–ª–∞–Ω!")
                return True
            
        except Exception as e:
            print(f"üí• –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –≤ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–º —Ç–µ—Å—Ç–µ: {e}")
            return False
        
        finally:
            # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API
            print(f"\nüí∞ –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø API:")
            print(f"   üî¢ –í—Å–µ–≥–æ –≤—ã–∑–æ–≤–æ–≤: {self.api_stats['total_calls']}")
            print(f"   üéØ –í—Å–µ–≥–æ —Ç–æ–∫–µ–Ω–æ–≤: {self.api_stats['total_tokens']}")
            
            for agent, calls in self.api_stats['calls_per_agent'].items():
                tokens = self.api_stats['tokens_per_agent'][agent]
                print(f"   üì° {agent}: {calls} –≤—ã–∑–æ–≤–æ–≤, {tokens} —Ç–æ–∫–µ–Ω–æ–≤")
            
            # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
            if self.test_project_path and os.path.exists(self.test_project_path):
                backup_path = f"/tmp/herzog_real_full_test_{int(datetime.now().timestamp())}"
                shutil.copytree(self.test_project_path, backup_path)
                print(f"\nüíæ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã: {backup_path}")
                
                shutil.rmtree(self.test_project_path)
                print(f"üßπ –í—Ä–µ–º–µ–Ω–Ω–∞—è –ø–∞–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∞: {self.test_project_path}")
    
    def _validate_final_result(self, final_data: Dict) -> List[str]:
        """–í–∞–ª–∏–¥–∏—Ä—É–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞"""
        errors = []
        
        work_packages = final_data['results']['work_packages']
        source_works = final_data['source_work_items']
        
        # 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –≤—Å–µ —Ä–∞–±–æ—Ç—ã –Ω–∞–∑–Ω–∞—á–µ–Ω—ã
        unassigned = [w for w in source_works if not w.get('package_id')]
        if unassigned:
            errors.append(f"–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–æ —Ä–∞–±–æ—Ç: {len(unassigned)}")
        
        # 2. –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —É –ø–∞–∫–µ—Ç–æ–≤ –µ—Å—Ç—å —Ä–∞—Å—á–µ—Ç—ã
        without_calc = [p for p in work_packages if 'calculations' not in p]
        if without_calc:
            errors.append(f"–ü–∞–∫–µ—Ç–æ–≤ –±–µ–∑ —Ä–∞—Å—á–µ—Ç–æ–≤: {len(without_calc)}")
        
        # 3. –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —É –ø–∞–∫–µ—Ç–æ–≤ –µ—Å—Ç—å –∫–∞–ª–µ–Ω–¥–∞—Ä–Ω—ã–π –ø–ª–∞–Ω
        without_schedule = [p for p in work_packages if 'schedule_blocks' not in p]
        if without_schedule:
            errors.append(f"–ü–∞–∫–µ—Ç–æ–≤ –±–µ–∑ –ø–ª–∞–Ω–∞: {len(without_schedule)}")
        
        return errors

async def run_real_full_api_test():
    """–ó–∞–ø—É—Å–∫ –ø–æ–ª–Ω–æ–≥–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞ —Å —Ä–µ–∞–ª—å–Ω—ã–º API"""
    
    print("üöÄ –ü–û–õ–ù–´–ô –ò–ù–¢–ï–ì–†–ê–¶–ò–û–ù–ù–´–ô –¢–ï–°–¢ –° –†–ï–ê–õ–¨–ù–´–ú GEMINI API")
    print("=" * 70)
    print("‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï: –≠—Ç–æ—Ç —Ç–µ—Å—Ç –¥–µ–ª–∞–µ—Ç –ú–ù–û–ñ–ï–°–¢–í–ï–ù–ù–´–ï –≤—ã–∑–æ–≤—ã –∫ Gemini API")
    print("üí∞ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ API –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ—Ä–æ–≥–∏–º (–æ–∂–∏–¥–∞–µ—Ç—Å—è 10-15 –≤—ã–∑–æ–≤–æ–≤)")
    print("üîë –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ GEMINI_API_KEY —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –∏–º–µ–µ—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π –ª–∏–º–∏—Ç")
    print("‚è≥ –û–∂–∏–¥–∞–µ–º–æ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: 15-30 —Å–µ–∫—É–Ω–¥")
    print("=" * 70)
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å
    api_key = os.getenv('GEMINI_API_KEY')
    if not api_key:
        print("‚ùå GEMINI_API_KEY –Ω–µ –Ω–∞–π–¥–µ–Ω!")
        return False
    
    print(f"üîë API –∫–ª—é—á –Ω–∞–π–¥–µ–Ω: {api_key[:10]}...{api_key[-4:]}")
    
    # –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ 
    print("\n‚ùì –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø–æ–ª–Ω—ã–π —Ç–µ—Å—Ç —Å —Ä–µ–∞–ª—å–Ω—ã–º API? (y/N): ", end='')
    confirmation = 'y'  # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
    
    if confirmation.lower() != 'y':
        print("üö´ –¢–µ—Å—Ç –æ—Ç–º–µ–Ω–µ–Ω")
        return False
    
    print("\nüéØ –ó–ê–ü–£–°–ö –ü–û–õ–ù–û–ì–û –ò–ù–¢–ï–ì–†–ê–¶–ò–û–ù–ù–û–ì–û –¢–ï–°–¢–ê...")
    
    tester = TestRealFullPipeline()
    
    try:
        success = await tester.test_real_full_pipeline()
        
        if success:
            print("\n" + "=" * 70)
            print("üéâ –ü–û–õ–ù–´–ô –ò–ù–¢–ï–ì–†–ê–¶–ò–û–ù–ù–´–ô –¢–ï–°–¢ –ü–†–û–ô–î–ï–ù –£–°–ü–ï–®–ù–û!")
            print("‚úÖ –í—Å–µ —á–µ—Ç—ã—Ä–µ –∞–≥–µ–Ω—Ç–∞ —Ä–∞–±–æ—Ç–∞—é—Ç —Å —Ä–µ–∞–ª—å–Ω—ã–º Gemini AI")
            print("üèóÔ∏è –°–∏—Å—Ç–µ–º–∞ HerZog v3.0 –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–æ–¥–∞–∫—à–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é")
            return True
        else:
            print("\n" + "=" * 70)
            print("‚ùå –ò–ù–¢–ï–ì–†–ê–¶–ò–û–ù–ù–´–ô –¢–ï–°–¢ –ü–†–û–í–ê–õ–ï–ù")
            print("üîß –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–æ—Ä–∞–±–æ—Ç–∫–∞ –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å —Ä–µ–∞–ª—å–Ω—ã–º AI")
            return False
            
    except Exception as e:
        print(f"\nüí• –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê: {e}")
        return False

if __name__ == "__main__":
    # –ó–∞–ø—É—Å–∫ –ø–æ–ª–Ω–æ–≥–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞
    asyncio.run(run_real_full_api_test())